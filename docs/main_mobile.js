var a=['preventDefault','stopPropagation','type','file','target','files','dataTransfer','onload','height','width','push','dest','input\x20vertically\x20long\x20image','pop','input\x20horizontally\x20long\x20image','shift','imageSmoothingQuality','high','drawImage','getImageData','change','addEventListener','touchstart','touchend','#src','hammer','swiperight','doubletap','scroll','result','readAsDataURL','getElementById','getContext','dest_file','src_file','getBoundingClientRect','left','top','touches','clientX','clientY','rgba(','lineWidth','round','beginPath','moveTo','lineTo','stroke','closePath','data','removeEventListener','touchmove','off','length','abs','putImageData','save','href','toDataURL','src'];(function(c,d){var e=function(f){while(--f){c['push'](c['shift']());}};e(++d);}(a,0x167));var b=function(c,d){c=c-0x0;var e=a[c];return e;};const max_canvas_size=0xeb;const select_color=[0x0,0xff,0xff,0xff];var fit_width=new Array();var fit_height=new Array();var loaded_img_count=0x0;var dest_canvas,src_canvas,result_canvas;var dest_ctx,src_ctx,result_ctx;var dest_img,src_img,result_img;var dest_file,src_file;var selected_pixels;function initCanvas(c){var d=new Image();if(c=='dest'){var e=dest_ctx;var f=dest_canvas;d=dest_img;}else if(c==b('0x0')){var e=src_ctx;var f=src_canvas;d=src_img;}else{return null;}var i=function(j){j[b('0x1')]();j[b('0x2')]();return![];};var k=function(l){l[b('0x1')]();if(l['target'][b('0x3')]==b('0x4')){var m=l[b('0x5')][b('0x6')][0x0];}else{var m=l[b('0x7')][b('0x6')][0x0];}d[b('0x8')]=function(){var o=d[b('0x9')]/d[b('0xa')];if(~~(o*max_canvas_size)>=max_canvas_size){fit_width[b('0xb')](~~(max_canvas_size/o));fit_height['push'](max_canvas_size);}else{fit_width['push'](max_canvas_size);fit_height[b('0xb')](~~(max_canvas_size*o));}var p=!![];if(loaded_img_count>0x0){if(c==='src'&&fit_width[0x1]>fit_width[0x0]||c===b('0xc')&&fit_width[0x1]<fit_width[0x0]){alert(b('0xd'));fit_width[b('0xe')]();fit_height[b('0xe')]();p=![];}else if(c===b('0x0')&&fit_height[0x1]>fit_height[0x0]||c==='dest'&&fit_height[0x1]<fit_height[0x0]){alert(b('0xf'));fit_width[b('0xe')]();fit_height[b('0xe')]();p=![];}else{fit_width[b('0x10')]();fit_height['shift']();p=!![];}}if(p){f[b('0xa')]=fit_width[0x0];f[b('0x9')]=fit_height[0x0];e[b('0x11')]=b('0x12');e[b('0x13')](this,0x0,0x0,f[b('0xa')],f[b('0x9')]);++loaded_img_count;if(c=='dest'){result_canvas[b('0xa')]=f[b('0xa')];result_canvas['height']=f[b('0x9')];result_img=d;result_img[b('0x8')]=new function(){e[b('0x11')]=b('0x12');result_ctx[b('0x13')](result_img,0x0,0x0,result_canvas[b('0xa')],result_canvas[b('0x9')]);++loaded_img_count;}();}if(loaded_img_count===0x3){pixels=src_ctx[b('0x14')](0x0,0x0,src_canvas[b('0xa')],src_canvas[b('0x9')]);original_src_pixels=pixels;dest_file['removeEventListener'](b('0x15'),k,![]);src_file['removeEventListener'](b('0x15'),k,![]);calSourceCanvasOffset();src_canvas[b('0x16')]('touchmove',draw,!![]);src_canvas['addEventListener'](b('0x17'),startSelcting,!![]);src_canvas[b('0x16')](b('0x18'),finishSelcting,!![]);$(b('0x19'))[b('0x1a')]()['on'](b('0x1b'),setSelectedArea);$(b('0x19'))[b('0x1a')]()['on'](b('0x1c'),setSelectedArea);window[b('0x16')](b('0x1d'),calSourceCanvasOffset);}}};var q=new FileReader();q[b('0x8')]=function(r){d['src']=r[b('0x5')][b('0x1e')];};q[b('0x1f')](m);};if(c==b('0xc')){dest_file[b('0x16')]('change',k,![]);}else if(c==b('0x0')){src_file[b('0x16')]('change',k,![]);}};window[b('0x8')]=new function(){dest_canvas=document[b('0x20')](b('0xc'));src_canvas=document[b('0x20')](b('0x0'));result_canvas=document[b('0x20')](b('0x1e'));dest_ctx=dest_canvas[b('0x21')]('2d');src_ctx=src_canvas['getContext']('2d');result_ctx=result_canvas[b('0x21')]('2d');dest_file=document[b('0x20')](b('0x22'));src_file=document[b('0x20')](b('0x23'));dest_img=new Image();src_img=new Image();result_img=new Image();initCanvas(b('0xc'));initCanvas('src');}();var isSelecting=![];prev_point={'x':0x0,'y':0x0};var src_canvas_offset={'y':0x0};var pixels;var original_src_pixels;function calSourceCanvasOffset(){var s=src_canvas[b('0x24')]();src_canvas_offset['x']=s[b('0x25')];src_canvas_offset['y']=s[b('0x26')];}function draw(t){t['preventDefault']();if(isSelecting){var u=t[b('0x27')][0x0][b('0x28')]-src_canvas_offset['x'];var v=t[b('0x27')][0x0][b('0x29')]-src_canvas_offset['y'];var w=~~(0x4*(u+src_canvas['width']*v));src_ctx['strokeStyle']=b('0x2a')+select_color[0x0]+','+select_color[0x1]+','+select_color[0x2]+','+0x1+')';src_ctx[b('0x2b')]=0x1e;src_ctx['lineJoin']=b('0x2c');src_ctx['lineCap']=b('0x2c');src_ctx[b('0x2d')]();src_ctx[b('0x2e')](prev_point['x'],prev_point['y']);src_ctx[b('0x2f')](u,v);src_ctx[b('0x30')]();src_ctx[b('0x31')]();prev_point['x']=u;prev_point['y']=v;}}function startSelcting(x){isSelecting=!![];prev_point['x']=x[b('0x27')][0x0][b('0x28')]-src_canvas_offset['x'];prev_point['y']=x['touches'][0x0]['clientY']-src_canvas_offset['y'];}function finishSelcting(y){isSelecting=![];}var selected_position_moved={'x':0x0,'y':0x0};function setSelectedArea(z){isSelecting=![];var A=dest_ctx['getImageData'](0x0,0x0,dest_canvas[b('0xa')],dest_canvas[b('0x9')]);var B=src_ctx[b('0x14')](0x0,0x0,src_canvas[b('0xa')],src_canvas[b('0x9')]);var C=result_ctx['getImageData'](0x0,0x0,result_canvas['width'],result_canvas['height']);selected_pixels=dest_ctx['getImageData'](0x0,0x0,dest_canvas['width'],dest_canvas[b('0x9')]);for(var D=0x1;D<src_canvas[b('0xa')]-0x1;D++){for(var E=0x1;E<src_canvas[b('0x9')]-0x1;E++){var F=0x4*(D+E*src_canvas[b('0xa')]);if(B['data'][F+0x0]==select_color[0x0]&&B[b('0x32')][F+0x1]==select_color[0x1]&&B[b('0x32')][F+0x2]==select_color[0x2]){var G=F+0x4*(selected_position_moved['x']+selected_position_moved['y']*src_canvas[b('0xa')]);for(var H=0x0;H<0x3;H++){C[b('0x32')][G+H]=original_src_pixels[b('0x32')][F+H];selected_pixels[b('0x32')][F+H]=B['data'][F+H];}}}}result_ctx['putImageData'](C,0x0,0x0);src_canvas[b('0x33')](b('0x34'),draw,!![]);src_canvas[b('0x33')](b('0x17'),startSelcting,!![]);src_canvas['removeEventListener'](b('0x18'),finishSelcting,!![]);$(b('0x19'))['hammer']()[b('0x35')]('swiperight',setSelectedArea);$(b('0x19'))[b('0x1a')]()['off'](b('0x1c'),setSelectedArea);calResultCanvasOffset();result_canvas['addEventListener'](b('0x34'),moveingBlendPos,![]);result_canvas['addEventListener'](b('0x17'),startMovingBlendPos,![]);result_canvas[b('0x16')](b('0x18'),finishMovingBlendPos,![]);window[b('0x16')](b('0x1d'),calResultCanvasOffset);}prev_point2={'x':0x0,'y':0x0};var result_canvas_offset={'x':0x0,'y':0x0};var moving=![];function moveingBlendPos(I){var J=dest_ctx[b('0x14')](0x0,0x0,dest_canvas[b('0xa')],dest_canvas['height']);if(moving){var K=I[b('0x27')][0x0][b('0x28')]-result_canvas_offset['x'];var L=I[b('0x27')][0x0]['clientY']-result_canvas_offset['y'];selected_position_moved['x']=~~(K-prev_point2['x']);selected_position_moved['y']=~~(L-prev_point2['y']);result_ctx['putImageData'](J,0x0,0x0);setSelectedArea();}}function calResultCanvasOffset(M){var N=result_canvas[b('0x24')]();result_canvas_offset['x']=N[b('0x25')];result_canvas_offset['y']=N[b('0x26')];}function startMovingBlendPos(O){moving=!![];prev_point2['x']=O[b('0x27')][0x0]['clientX']-result_canvas_offset['x'];prev_point2['y']=O[b('0x27')][0x0][b('0x29')]-result_canvas_offset['y'];}function finishMovingBlendPos(P){moving=![];}function poissonImporting(Q){var R=dest_ctx[b('0x14')](0x0,0x0,dest_canvas['width'],dest_canvas[b('0x9')]);var S=src_ctx[b('0x14')](0x0,0x0,src_canvas[b('0xa')],src_canvas[b('0x9')]);var T=dest_ctx[b('0x14')](0x0,0x0,dest_canvas['width'],dest_canvas[b('0x9')]);const U=result_canvas[b('0x9')];const V=result_canvas[b('0xa')];var W,X,Y;var Z=0x1;var a0=0x0;while(!![]){W=0x0;X=0x0;for(var a1=0x1;a1<U-0x1;a1++){for(var a2=0x1;a2<V-0x1;a2++){var a3=(a1*V+a2)*0x4;if(selected_pixels[b('0x32')][a3+0x0]===select_color[0x0]&&selected_pixels[b('0x32')][a3+0x1]===select_color[0x1]&&selected_pixels[b('0x32')][a3+0x2]===select_color[0x2]&&selected_pixels[b('0x32')][a3+0x3]===select_color[0x3]){var a4=a3+~~0x4*(selected_position_moved['x']+selected_position_moved['y']*V);var a5=[((a1-0x1)*V+a2)*0x4,((a1+0x1)*V+a2)*0x4,(a1*V+(a2-0x1))*0x4,(a1*V+(a2+0x1))*0x4];var a6=a5[b('0x36')];for(var a7=0x0;a7<0x3;a7++){var a8=0x0;var a9=0x0;var aa=0x0;for(var ab=0x0;ab<a6;ab++){var ac=a5[ab]+0x4*(selected_position_moved['x']+selected_position_moved['y']*V);var ad=T[b('0x32')][ac+a7];var ae=R[b('0x32')][a4+a7];var af=R[b('0x32')][ac+a7];var ag=original_src_pixels[b('0x32')][a3+a7];var ah=original_src_pixels[b('0x32')][a5[ab]+a7];if(selected_pixels[b('0x32')][a5[ab]+0x0]===select_color[0x0]&&selected_pixels[b('0x32')][a5[ab]+0x1]===select_color[0x1]&&selected_pixels[b('0x32')][a5[ab]+0x2]===select_color[0x2]&&selected_pixels['data'][a5[ab]+0x3]===select_color[0x3]){a8+=ad;}else{a9+=af;}if(Q===0x1){aa+=Math[b('0x37')](ag-ah)>Math[b('0x37')](ae-af)?ag-ah:ae-af;}else{aa+=ag-ah;}}new_fp=(a8+aa+a9)/a6;W+=Math[b('0x37')](new_fp-R[b('0x32')][a4+a7]);X+=Math['abs'](new_fp);T[b('0x32')][a4+a7]=new_fp;}}}}var ai=0x3e8*W/X;ai*=0.001;if(Z===ai){break;}a0++;if(a0>0x96){a0=0x0;break;}Z=ai;console['log'](W,ai);};result_ctx[b('0x38')](T,0x0,0x0);}function debug(){var aj=dest_ctx[b('0x14')](0x0,0x0,dest_canvas[b('0xa')],dest_canvas['height']);var ak=src_ctx[b('0x14')](0x0,0x0,src_canvas[b('0xa')],src_canvas[b('0x9')]);var al=result_ctx[b('0x14')](0x0,0x0,result_canvas[b('0xa')],result_canvas[b('0x9')]);result_ctx[b('0x38')](aj,0x0,0x0);}function save(){document[b('0x20')](b('0x39'))[b('0x3a')]=result_canvas[b('0x3b')]();}function reset(){prev_point2['x']=prev_point2['y']=0x0;selected_position_moved['x']=selected_position_moved['y']=0x0;result_ctx[b('0x38')](dest_ctx[b('0x14')](0x0,0x0,dest_canvas[b('0xa')],dest_canvas[b('0x9')]),0x0,0x0);src_ctx[b('0x38')](original_src_pixels,0x0,0x0);result_canvas[b('0x33')](b('0x34'),moveingBlendPos,![]);result_canvas[b('0x33')]('touchstart',startMovingBlendPos,![]);result_canvas[b('0x33')](b('0x18'),finishMovingBlendPos,![]);calSourceCanvasOffset();src_canvas['addEventListener']('touchmove',draw,!![]);src_canvas[b('0x16')](b('0x17'),startSelcting,!![]);src_canvas[b('0x16')](b('0x18'),finishSelcting,!![]);$(b('0x19'))[b('0x1a')]()['on'](b('0x1b'),setSelectedArea);$(b('0x19'))['hammer']()['on'](b('0x1c'),setSelectedArea);}function inverseRGB(){var am=result_ctx[b('0x14')](0x0,0x0,result_canvas[b('0xa')],result_canvas[b('0x9')]);var an=am[b('0xa')]*am['height']*0x4;for(var ao=0x0;ao<an;ao+=0x4){var ap=am[b('0x32')][ao+0x0];var aq=am[b('0x32')][ao+0x1];var ar=am[b('0x32')][ao+0x2];am[b('0x32')][ao+0x0]=0xff-ap;am['data'][ao+0x1]=0xff-aq;am[b('0x32')][ao+0x2]=0xff-ar;}result_ctx[b('0x38')](am,0x0,0x0);}
