var a=['drop','addEventListener','mousemove','mousedown','mouseup','scroll','result','dragenter','change','getElementById','getContext','src_file','calSourceCanvasOffset','getBoundingClientRect','top','draw','clientY','strokeStyle','rgba(','lineWidth','lineJoin','round','lineCap','moveTo','lineTo','stroke','closePath','startSelcting','setSelectedArea','data','putImageData','dblclick','calResultCanvasOffset','left','startMovingBlendPos','clientX','finishMovingBlendPos','abs','save','href','inverseRGB','log','initCanvas','preventDefault','target','dest','type','file','files','dataTransfer','onload','height','width','push','src','input\x20vertically\x20long\x20image','pop','input\x20horizontally\x20long\x20image','shift','imageSmoothingQuality','high','drawImage','getImageData','dragover','removeEventListener'];(function(c,d){var e=function(f){while(--f){c['push'](c['shift']());}};e(++d);}(a,0x6a));var b=function(c,d){c=c-0x0;var e=a[c];return e;};const max_canvas_size=0xeb;const select_color=[0x0,0xff,0xff,0xff];var fit_width=new Array();var fit_height=new Array();var rendered_img_count=0x0;var dest_canvas,src_canvas,result_canvas;var dest_ctx,src_ctx,result_ctx;var dest_img,src_img,result_img;var dest_file,src_file;var selected_pixels;function initCanvas(c){console[b('0x0')](b('0x1'));var d=new Image();if(c=='dest'){var e=dest_ctx;var f=dest_canvas;d=dest_img;}else{var e=src_ctx;var f=src_canvas;d=src_img;}var i=function(j){j[b('0x2')]();j['stopPropagation']();return![];};var k=function(l){l[b('0x2')]();c=l[b('0x3')]['id']['replace'](/_file/,'');if(c==b('0x4')){var m=dest_ctx;var n=dest_canvas;d=dest_img;}else{var m=src_ctx;var n=src_canvas;d=src_img;}if(l[b('0x3')][b('0x5')]==b('0x6')){var q=l[b('0x3')][b('0x7')][0x0];}else{var q=l[b('0x8')]['files'][0x0];}d[b('0x9')]=function(){console['log']('load\x20Image'+'\x20'+c);var s=d[b('0xa')]/d[b('0xb')];if(~~(s*max_canvas_size)>=max_canvas_size){fit_width['push'](~~(max_canvas_size/s));fit_height[b('0xc')](max_canvas_size);}else{fit_width[b('0xc')](max_canvas_size);fit_height[b('0xc')](~~(max_canvas_size*s));}var t=!![];if(rendered_img_count>0x0){if(c===b('0xd')&&fit_width[0x1]>fit_width[0x0]||c===b('0x4')&&fit_width[0x1]<fit_width[0x0]){alert(b('0xe'));fit_width[b('0xf')]();fit_height[b('0xf')]();t=![];}else if(c===b('0xd')&&fit_height[0x1]>fit_height[0x0]||c===b('0x4')&&fit_height[0x1]<fit_height[0x0]){alert(b('0x10'));fit_width[b('0xf')]();fit_height[b('0xf')]();t=![];}else{fit_width['shift']();fit_height[b('0x11')]();t=!![];}}if(t){n[b('0xb')]=fit_width[0x0];n[b('0xa')]=fit_height[0x0];m[b('0x12')]=b('0x13');m[b('0x14')](this,0x0,0x0,n[b('0xb')],n['height']);++rendered_img_count;if(c==b('0x4')){result_canvas[b('0xb')]=n['width'];result_canvas[b('0xa')]=n[b('0xa')];result_img=d;result_img[b('0x9')]=new function(){m['imageSmoothingQuality']='high';result_ctx['drawImage'](result_img,0x0,0x0,result_canvas[b('0xb')],result_canvas[b('0xa')]);++rendered_img_count;}();}if(rendered_img_count===0x3){fit_width=[];fit_height=[];pixels=src_ctx[b('0x15')](0x0,0x0,src_canvas[b('0xb')],src_canvas[b('0xa')]);original_src_pixels=pixels;document['removeEventListener'](b('0x16'),i,![]);document[b('0x17')]('dragenter',i,![]);document[b('0x17')](b('0x18'),i,![]);dest_canvas[b('0x17')](b('0x18'),k,![]);src_canvas[b('0x17')](b('0x18'),k,![]);calSourceCanvasOffset();src_canvas[b('0x19')](b('0x1a'),draw,!![]);src_canvas[b('0x19')](b('0x1b'),startSelcting,!![]);src_canvas[b('0x19')](b('0x1c'),finishSelcting,!![]);src_canvas[b('0x19')]('dblclick',setSelectedArea,!![]);window[b('0x19')](b('0x1d'),calSourceCanvasOffset);}}};var u=new FileReader();u[b('0x9')]=function(v){d[b('0xd')]=v[b('0x3')][b('0x1e')];};u['readAsDataURL'](q);};document['addEventListener'](b('0x16'),i,![]);document[b('0x19')](b('0x1f'),i,![]);document[b('0x19')](b('0x18'),i,![]);f[b('0x19')](b('0x18'),k,![]);if(c=='dest'){dest_file[b('0x19')](b('0x20'),k,![]);}else if(c=='src'){src_file[b('0x19')](b('0x20'),k,![]);}};window['onload']=new function(){dest_canvas=document[b('0x21')](b('0x4'));src_canvas=document['getElementById'](b('0xd'));result_canvas=document[b('0x21')](b('0x1e'));dest_ctx=dest_canvas[b('0x22')]('2d');src_ctx=src_canvas[b('0x22')]('2d');result_ctx=result_canvas[b('0x22')]('2d');dest_file=document['getElementById']('dest_file');src_file=document[b('0x21')](b('0x23'));dest_img=new Image();src_img=new Image();result_img=new Image();initCanvas(b('0x4'));initCanvas(b('0xd'));}();var isSelecting=![];prev_point={'x':0x0,'y':0x0};var src_canvas_offset={'y':0x0};var pixels;var original_src_pixels;function calSourceCanvasOffset(){console[b('0x0')](b('0x24'));var w=src_canvas[b('0x25')]();src_canvas_offset['x']=w['left'];src_canvas_offset['y']=w[b('0x26')];}function draw(x){if(isSelecting){console[b('0x0')](b('0x27'));var y=x['clientX']-src_canvas_offset['x'];var z=x[b('0x28')]-src_canvas_offset['y'];var A=~~(0x4*(y+src_canvas[b('0xb')]*z));src_ctx[b('0x29')]=b('0x2a')+select_color[0x0]+','+select_color[0x1]+','+select_color[0x2]+','+0x1+')';src_ctx[b('0x2b')]=0x1e;src_ctx[b('0x2c')]=b('0x2d');src_ctx[b('0x2e')]=b('0x2d');src_ctx['beginPath']();src_ctx[b('0x2f')](prev_point['x'],prev_point['y']);src_ctx[b('0x30')](y,z);src_ctx[b('0x31')]();src_ctx[b('0x32')]();prev_point['x']=y;prev_point['y']=z;}}function startSelcting(B){console[b('0x0')](b('0x33'));isSelecting=!![];prev_point['x']=B['clientX']-src_canvas_offset['x'];prev_point['y']=B[b('0x28')]-src_canvas_offset['y'];}function finishSelcting(C){console[b('0x0')]('finishSelcting');isSelecting=![];}var selected_position_moved={'x':0x0,'y':0x0};function setSelectedArea(D){console[b('0x0')](b('0x34'));isSelecting=![];var E=dest_ctx[b('0x15')](0x0,0x0,dest_canvas[b('0xb')],dest_canvas[b('0xa')]);var F=src_ctx[b('0x15')](0x0,0x0,src_canvas[b('0xb')],src_canvas[b('0xa')]);var G=result_ctx[b('0x15')](0x0,0x0,result_canvas[b('0xb')],result_canvas[b('0xa')]);selected_pixels=dest_ctx[b('0x15')](0x0,0x0,dest_canvas[b('0xb')],dest_canvas[b('0xa')]);for(var H=0x1;H<src_canvas[b('0xb')]-0x1;H++){for(var I=0x1;I<src_canvas['height']-0x1;I++){var J=0x4*(H+I*src_canvas[b('0xb')]);if(F[b('0x35')][J+0x0]==select_color[0x0]&&F[b('0x35')][J+0x1]==select_color[0x1]&&F[b('0x35')][J+0x2]==select_color[0x2]){var K=J+0x4*(selected_position_moved['x']+selected_position_moved['y']*src_canvas[b('0xb')]);for(var L=0x0;L<0x3;L++){G['data'][K+L]=original_src_pixels[b('0x35')][J+L];selected_pixels[b('0x35')][J+L]=F[b('0x35')][J+L];}}}}result_ctx[b('0x36')](G,0x0,0x0);src_canvas[b('0x17')](b('0x1a'),draw,!![]);src_canvas[b('0x17')](b('0x1b'),startSelcting,!![]);src_canvas[b('0x17')](b('0x1c'),finishSelcting,!![]);src_canvas[b('0x17')](b('0x37'),setSelectedArea,!![]);calResultCanvasOffset();result_canvas[b('0x19')](b('0x1a'),moveingBlendPos,![]);result_canvas[b('0x19')](b('0x1b'),startMovingBlendPos,![]);result_canvas[b('0x19')](b('0x1c'),finishMovingBlendPos,![]);window[b('0x19')]('scroll',calResultCanvasOffset);}prev_point2={'x':0x0,'y':0x0};var result_canvas_offset={'x':0x0,'y':0x0};var moving=![];function moveingBlendPos(M){var N=dest_ctx[b('0x15')](0x0,0x0,dest_canvas['width'],dest_canvas[b('0xa')]);if(moving){console['log']('moving');var O=M['clientX']-result_canvas_offset['x'];var P=M[b('0x28')]-result_canvas_offset['y'];selected_position_moved['x']=~~(O-prev_point2['x']);selected_position_moved['y']=~~(P-prev_point2['y']);result_ctx[b('0x36')](N,0x0,0x0);setSelectedArea();}}function calResultCanvasOffset(Q){console[b('0x0')](b('0x38'));var R=result_canvas[b('0x25')]();result_canvas_offset['x']=R[b('0x39')];result_canvas_offset['y']=R[b('0x26')];}function startMovingBlendPos(S){console['log'](b('0x3a'));moving=!![];prev_point2['x']=S[b('0x3b')]-result_canvas_offset['x'];prev_point2['y']=S[b('0x28')]-result_canvas_offset['y'];}function finishMovingBlendPos(T){console[b('0x0')](b('0x3c'));moving=![];}function poissonImporting(U){var V=dest_ctx[b('0x15')](0x0,0x0,dest_canvas[b('0xb')],dest_canvas['height']);var W=src_ctx['getImageData'](0x0,0x0,src_canvas[b('0xb')],src_canvas[b('0xa')]);var X=dest_ctx[b('0x15')](0x0,0x0,dest_canvas[b('0xb')],dest_canvas[b('0xa')]);const Y=result_canvas[b('0xa')];const Z=result_canvas['width'];var a0,a1,a2;var a3=0x1;var a4=0x0;while(!![]){a0=0x0;a1=0x0;for(var a5=0x1;a5<Y-0x1;a5++){for(var a6=0x1;a6<Z-0x1;a6++){var a7=(a5*Z+a6)*0x4;if(selected_pixels[b('0x35')][a7+0x0]===select_color[0x0]&&selected_pixels[b('0x35')][a7+0x1]===select_color[0x1]&&selected_pixels[b('0x35')][a7+0x2]===select_color[0x2]&&selected_pixels['data'][a7+0x3]===select_color[0x3]){var a8=a7+~~0x4*(selected_position_moved['x']+selected_position_moved['y']*Z);var a9=[((a5-0x1)*Z+a6)*0x4,((a5+0x1)*Z+a6)*0x4,(a5*Z+(a6-0x1))*0x4,(a5*Z+(a6+0x1))*0x4];var aa=a9['length'];for(var ab=0x0;ab<0x3;ab++){var ac=0x0;var ad=0x0;var ae=0x0;for(var af=0x0;af<aa;af++){var ag=a9[af]+0x4*(selected_position_moved['x']+selected_position_moved['y']*Z);var ah=X[b('0x35')][ag+ab];var ai=V['data'][a8+ab];var aj=V[b('0x35')][ag+ab];var ak=original_src_pixels[b('0x35')][a7+ab];var al=original_src_pixels[b('0x35')][a9[af]+ab];if(selected_pixels[b('0x35')][a9[af]+0x0]===select_color[0x0]&&selected_pixels[b('0x35')][a9[af]+0x1]===select_color[0x1]&&selected_pixels[b('0x35')][a9[af]+0x2]===select_color[0x2]&&selected_pixels[b('0x35')][a9[af]+0x3]===select_color[0x3]){ac+=ah;}else{ad+=aj;}if(U===0x1){ae+=Math[b('0x3d')](ak-al)>Math[b('0x3d')](ai-aj)?ak-al:ai-aj;}else{ae+=ak-al;}}new_fp=(ac+ae+ad)/aa;a0+=Math[b('0x3d')](new_fp-V[b('0x35')][a8+ab]);a1+=Math['abs'](new_fp);X[b('0x35')][a8+ab]=new_fp;}}}}var am=0x3e8*a0/a1;am*=0.001;if(a3===am){break;}a4++;if(a4>0x96){a4=0x0;break;}a3=am;console['log'](a0,am);};result_ctx[b('0x36')](X,0x0,0x0);}function debug(){var an=dest_ctx['getImageData'](0x0,0x0,dest_canvas['width'],dest_canvas['height']);var ao=src_ctx['getImageData'](0x0,0x0,src_canvas[b('0xb')],src_canvas[b('0xa')]);var ap=result_ctx[b('0x15')](0x0,0x0,result_canvas[b('0xb')],result_canvas[b('0xa')]);result_ctx[b('0x36')](an,0x0,0x0);}function save(){console[b('0x0')](b('0x3e'));document[b('0x21')](b('0x3e'))[b('0x3f')]=result_canvas['toDataURL']();}function reset(){console[b('0x0')]('reset');prev_point2['x']=prev_point2['y']=0x0;selected_position_moved['x']=selected_position_moved['y']=0x0;result_ctx[b('0x36')](dest_ctx['getImageData'](0x0,0x0,dest_canvas[b('0xb')],dest_canvas['height']),0x0,0x0);src_ctx[b('0x36')](original_src_pixels,0x0,0x0);result_canvas[b('0x17')](b('0x1a'),moveingBlendPos,![]);result_canvas[b('0x17')](b('0x1b'),startMovingBlendPos,![]);result_canvas[b('0x17')]('mouseup',finishMovingBlendPos,![]);calSourceCanvasOffset();src_canvas[b('0x19')]('mousemove',draw,!![]);src_canvas[b('0x19')](b('0x1b'),startSelcting,!![]);src_canvas[b('0x19')](b('0x1c'),finishSelcting,!![]);src_canvas[b('0x19')](b('0x37'),setSelectedArea,!![]);}function inverseRGB(){console[b('0x0')](b('0x40'));var aq=result_ctx[b('0x15')](0x0,0x0,result_canvas[b('0xb')],result_canvas['height']);var ar=aq[b('0xb')]*aq[b('0xa')]*0x4;for(var as=0x0;as<ar;as+=0x4){var at=aq['data'][as+0x0];var au=aq[b('0x35')][as+0x1];var av=aq[b('0x35')][as+0x2];aq[b('0x35')][as+0x0]=0xff-at;aq[b('0x35')][as+0x1]=0xff-au;aq[b('0x35')][as+0x2]=0xff-av;}result_ctx[b('0x36')](aq,0x0,0x0);}